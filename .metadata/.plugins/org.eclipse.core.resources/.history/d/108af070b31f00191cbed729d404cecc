package com.assign.jdbc;

import java.io.IOException;
import java.sql.Connection;
import java.sql.Date;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.Scanner;



public class DbOperation {

	static PreparedStatement ps;
	static ResultSet rs;
	static Connection conn;

	public static void createTable() {
		try {
			if (conn == null)
			conn=	DBConnection.getConnection();

			ps = conn
					.prepareStatement("create table emp( EMPNO     int(4)  NOT NULL,"
							+ "ENAME     VARCHAR(10) ,"
							+ "  JOB       VARCHAR(9),"
							+ " MGR       int(4),"
							+ "  HIREDATE  DATE,"
							+ " SAL       double(7,2),"
							+ "COMM      double(7,2)," + "DEPTNO    int(2))");
		 ps.executeUpdate();
			
				System.out.println("Successfully created");
			

		} catch (SQLException e) {
			System.out.println("Creation FAiled " + e);
		}
	}
	public static void insertData() throws SQLException{
		
		Scanner obj=new Scanner(System.in);
		
		Employee emp=new Employee();
		
		System.out.println("enter employment number :");
		emp.setEmp_no(obj.nextInt());
		System.out.println("enter emplyee name:");
		emp.setEmp_name(obj.nextLine());
		System.out.println("enter job:");
		emp.setJob(obj.next());
		System.out.println("enter mgr:");
		emp.setMgr(obj.nextInt());
		System.out.println("enter hire date");
		emp.setHire_date(Date.valueOf(obj.next()));
		System.out.println("enter salary:");
		emp.setSalary(obj.nextDouble());
		System.out.println("enter comm:");
		emp.setComm(obj.nextDouble());
		System.out.println("enter department number");
		emp.setDept_no(obj.nextInt());
		
		
		try {
			if (conn == null)
			conn=	DBConnection.getConnection();

			ps = conn
					.prepareStatement("insert into eltp values(?,?,?,?,?,?,?,?)");
			ps.setInt(1, e.getEmp_no());
			ps.setString(2, e.getEmp_name());
			ps.setString(3, e.getJob());
			ps.setInt(4, e.getMgr());
			ps.setDate(5, e.getHire_date());
			ps.setDouble(6, e.getSalary());
			ps.setDouble(7, e.getComm());
			ps.setInt(8, e.getDept_no());
		int i= ps.executeUpdate();
		if(i>0)
			System.out.println("inserted successfully");
			
		
	}catch(Exception e1){
		System.out.println("insertion failed"+e);
	}
}
}
