package com.assign.jdbc;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;



public class DbOperation {

	static PreparedStatement ps;
	static ResultSet rs;
	static Connection conn;

	public static void createTable() {
		try {
			if (conn == null)
			conn=	DBConnection.getConnection();

			ps = conn
					.prepareStatement("create table emp( EMPNO     int(4)  NOT NULL,"
							+ "ENAME     VARCHAR(10) ,"
							+ "  JOB       VARCHAR(9),"
							+ " MGR       int(4),"
							+ "  HIREDATE  DATE,"
							+ " SAL       double(7,2),"
							+ "COMM      double(7,2)," + "DEPTNO    int(2))");
		 ps.executeUpdate();
			
				System.out.println("Successfully created");
			

		} catch (SQLException e) {
			System.out.println("Creation FAiled " + e);
		}
	}
	public static void insertData(Employee e){
		try {
			if (conn == null)
			conn=	DBConnection.getConnection();

			ps = conn
					.prepareStatement("insert into eltp values(?,?,?,?,?,?,?,?)");
			ps.setInt(1, e.getEmp_no());
			ps.setString(2, e.getEmp_name());
			ps.setString(3, e.getJob());
			ps.setInt(4, e.getMgr());
			ps.setDate(5, e.getHire_date());
		 ps.executeUpdate();
	}
}
