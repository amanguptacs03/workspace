package com.assign.nugget_10;

import java.sql.Connection;
import java.sql.Date;
import java.sql.PreparedStatement;
import java.sql.SQLException;

public class Movie {

	private String name;
	private String language;

	public Movie(String name,String language) {
		super();
		this.name = name;
		this.language=language;
	}

	public void newShow(Date date) throws SQLException {
		Connection conn=com.assign.nugget_10.Connection.getConnection();
		PreparedStatement ps=conn.prepareStatement("insert into showdetails values(0,?,?,?)");
		ps.setString(1, this.name);
		ps.setString(2, this.language);
		ps.setDate(3, date);
	int i=	ps.executeUpdate();
System.out.println(i);

	}

	public void update(Date date) throws SQLException {
		Connection conn=com.assign.nugget_10.Connection.getConnection();
		PreparedStatement ps=conn.prepareStatement("update showdetails set show =? where movie =?");
		
		ps.setDate(0, date);
	//	ps.setString(1, movie);
		ps.executeUpdate();

	}

	public void delete(Date date) throws SQLException {
		Connection conn=com.assign.nugget_10.Connection.getConnection();
		PreparedStatement ps=conn.prepareStatement("delete from showdetails where movie=? and language=? and 'show'=? ");
		ps.setString(0, this.name);
		ps.setString(1, this.language);
		ps.setDate(2, date);
		ps.executeUpdate();

	}

}
